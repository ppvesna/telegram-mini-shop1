<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <title>–ú–∞–≥–∞–∑–∏–Ω</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    body {
      font-family: Arial;
      background: #f5f5f5;
      padding: 10px;
    }
    h2 { text-align: center; }

    .card {
      background: white;
      padding: 12px;
      margin: 10px 0;
      border-radius: 10px;
    }

    button {
      width: 100%;
      padding: 10px;
      margin-top: 6px;
      background: #0088cc;
      color: white;
      border: none;
      border-radius: 6px;
      font-size: 16px;
    }

    .back { background: #777; }
    .cart { background: #28a745; }
  </style>
</head>
<body>

<h2 id="title">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
<div id="content"></div>

<script>
  const tg = window.Telegram.WebApp;
  tg.expand();

  const categories = {
    clothes: {
      name: "üß¢ –û–¥–µ–∂–¥–∞",
      products: [
        { name: "–§—É—Ç–±–æ–ª–∫–∞", price: 1000 },
        { name: "–ö–µ–ø–∫–∞", price: 700 }
      ]
    },
    tech: {
      name: "üì± –≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞",
      products: [
        { name: "–ù–∞—É—à–Ω–∏–∫–∏", price: 2500 },
        { name: "–ü–∞—É—ç—Ä–±–∞–Ω–∫", price: 3000 }
      ]
    }
  };

  let cart = [];

  const content = document.getElementById("content");
  const title = document.getElementById("title");

  function showCategories() {
    title.innerText = "–ö–∞—Ç–µ–≥–æ—Ä–∏–∏";
    content.innerHTML = "";

    for (let key in categories) {
      const btn = document.createElement("button");
      btn.innerText = categories[key].name;
      btn.onclick = () => showProducts(key);
      content.appendChild(btn);
    }

    const cartBtn = document.createElement("button");
    cartBtn.className = "cart";
    cartBtn.innerText = "üõí –ö–æ—Ä–∑–∏–Ω–∞";
    cartBtn.onclick = showCart;
    content.appendChild(cartBtn);
  }

  function showProducts(key) {
    const cat = categories[key];
    title.innerText = cat.name;
    content.innerHTML = "";

    cat.products.forEach(p => {
      const div = document.createElement("div");
      div.className = "card";
      div.innerHTML = `
        <b>${p.name}</b><br>
        –¶–µ–Ω–∞: ${p.price} ‚ÇΩ
        <button onclick="addToCart('${p.name}', ${p.price})">
          –î–æ–±–∞–≤–∏—Ç—å
        </button>
      `;
      content.appendChild(div);
    });

    backButton();
  }

  function addToCart(name, price) {
    cart.push({ name, price });
    alert("–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ—Ä–∑–∏–Ω—É");
  }

  function showCart() {
    title.innerText = "üõí –ö–æ—Ä–∑–∏–Ω–∞";
    content.innerHTML = "";

    if (cart.length === 0) {
      content.innerHTML = "<p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>";
      backButton();
      return;
    }

    let total = 0;

    cart.forEach(item => {
      total += item.price;
      const div = document.createElement("div");
      div.className = "card";
      div.innerHTML = `${item.name} ‚Äî ${item.price} ‚ÇΩ`;
      content.appendChild(div);
    });

    const totalDiv = document.createElement("div");
    totalDiv.className = "card";
    totalDiv.innerHTML = `<b>–ò—Ç–æ–≥–æ: ${total} ‚ÇΩ</b>`;
    content.appendChild(totalDiv);

    const orderBtn = document.createElement("button");
    orderBtn.innerText = "üì¶ –û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑";
    orderBtn.onclick = sendOrder;
    content.appendChild(orderBtn);

    backButton();
  }

  function sendOrder() {
    tg.sendData(JSON.stringify(cart));
    alert("–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!");
    cart = [];
    showCategories();
  }

  function backButton() {
    const back = document.createElement("button");
    back.className = "back";
    back.innerText = "‚Üê –ù–∞–∑–∞–¥";
    back.onclick = showCategories;
    content.appendChild(back);
  }

  showCategories();
</script>

</body>
</html>
