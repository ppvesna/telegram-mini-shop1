<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>–ú–∞–≥–∞–∑–∏–Ω</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        body { font-family: Arial; padding: 15px; }
        button { margin: 5px 0; padding: 6px 10px; }
        input { width: 100%; padding: 6px; margin: 5px 0; }
        .product { margin-bottom: 8px; }
        .cart { margin-top: 20px; border-top: 1px solid #ccc; padding-top: 10px; }
    </style>
</head>
<body>

<h2>–ö–∞—Ç–µ–≥–æ—Ä–∏–∏</h2>
<div id="categories"></div>

<h3>–¢–æ–≤–∞—Ä—ã</h3>
<div id="products"></div>

<div class="cart">
    <h3>üõí –ö–æ—Ä–∑–∏–Ω–∞</h3>
    <div id="cart"></div>
    <b id="total"></b>

    <h3>üìã –î–∞–Ω–Ω—ã–µ –¥–ª—è –∑–∞–∫–∞–∑–∞</h3>
    <input id="name" placeholder="–í–∞—à–µ –∏–º—è">
    <input id="phone" placeholder="–¢–µ–ª–µ—Ñ–æ–Ω">

</div>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready();

    let cart = [];

    const categories = [
        { id: 1, name: "–û–¥–µ–∂–¥–∞" },
        { id: 2, name: "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞" }
    ];

    const products = [
        { id: 1, name: "–§—É—Ç–±–æ–ª–∫–∞", price: 1200, category_id: 1 },
        { id: 2, name: "–ö—É—Ä—Ç–∫–∞", price: 3500, category_id: 1 },
        { id: 3, name: "–ù–∞—É—à–Ω–∏–∫–∏", price: 2500, category_id: 2 },
        { id: 4, name: "–ú—ã—à—å", price: 1500, category_id: 2 }
    ];

    const catDiv = document.getElementById("categories");
    const prodDiv = document.getElementById("products");
    const cartDiv = document.getElementById("cart");
    const totalDiv = document.getElementById("total");

    categories.forEach(cat => {
        const btn = document.createElement("button");
        btn.innerText = cat.name;
        btn.onclick = () => showProducts(cat.id);
        catDiv.appendChild(btn);
    });

    function showProducts(catId) {
        prodDiv.innerHTML = "";
        products.filter(p => p.category_id === catId)
            .forEach(p => {
                const div = document.createElement("div");
                div.className = "product";
                div.innerHTML = `
                    ${p.name} ‚Äî ${p.price} ‚ÇΩ
                    <button onclick='addToCart(${JSON.stringify(p)})'>+</button>
                `;
                prodDiv.appendChild(div);
            });
    }

    function addToCart(product) {
        cart.push(product);
        renderCart();
    }

    function renderCart() {
        cartDiv.innerHTML = "";
        let total = 0;

        cart.forEach((item, index) => {
            total += item.price;
            const div = document.createElement("div");
            div.innerHTML = `${item.name} ‚Äî ${item.price} ‚ÇΩ 
                <button onclick="removeItem(${index})">‚ùå</button>`;
            cartDiv.appendChild(div);
        });

        totalDiv.innerText = "–ò—Ç–æ–≥–æ: " + total + " ‚ÇΩ";
    }

    function removeItem(index) {
        cart.splice(index, 1);
        renderCart();
    }

    function sendOrder() {
        const name = document.getElementById("name").value.trim();
        const phone = document.getElementById("phone").value.trim();

        if (!name || !phone) {
            alert("–í–≤–µ–¥–∏—Ç–µ –∏–º—è –∏ —Ç–µ–ª–µ—Ñ–æ–Ω");
            return;
        }

        if (cart.length === 0) {
            alert("–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞");
            return;
        }

        const order = {
            name,
            phone,
            items: cart
        };

        tg.sendData(JSON.stringify(order));
        tg.close();
    }
</script>
<script>
document.getElementById("orderBtn").onclick = () => {
    const data = {
        name: document.getElementById("name").value,
        phone: document.getElementById("phone").value,
        items: cart,
        total: cart.reduce((s, i) => s + i.price, 0)
    };

    Telegram.WebApp.sendData(JSON.stringify(data));
};
</script>

    
</body>
</html>
