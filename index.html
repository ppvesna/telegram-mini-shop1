<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Магазин</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

<h2>Категории</h2>
<div id="categories"></div>

<h3>Товары</h3>
<div id="products"></div>

<button onclick="sendOrder()">Оформить заказ</button>

<script>
    const tg = window.Telegram.WebApp;
    tg.ready();

    let cart = [];

    const categories = [
        { id: 1, name: "Одежда" },
        { id: 2, name: "Электроника" }
    ];

    const products = [
        { id: 1, name: "Футболка", price: 1200, category_id: 1 },
        { id: 2, name: "Куртка", price: 3500, category_id: 1 },
        { id: 3, name: "Наушники", price: 2500, category_id: 2 },
        { id: 4, name: "Мышь", price: 1500, category_id: 2 }
    ];

    const catDiv = document.getElementById("categories");
    const prodDiv = document.getElementById("products");

    categories.forEach(cat => {
        const btn = document.createElement("button");
        btn.innerText = cat.name;
        btn.onclick = () => showProducts(cat.id);
        catDiv.appendChild(btn);
    });

    function showProducts(catId) {
        prodDiv.innerHTML = "";
        products.filter(p => p.category_id === catId)
            .forEach(p => {
                const div = document.createElement("div");
                div.innerHTML = `${p.name} — ${p.price} ₽ 
                <button onclick='addToCart(${JSON.stringify(p)})'>+</button>`;
                prodDiv.appendChild(div);
            });
    }

    function addToCart(product) {
        cart.push(product);
        alert("Добавлено в корзину");
    }

    function sendOrder() {
        tg.sendData(JSON.stringify(cart));
        tg.close();
    }
</script>

</body>
</html>
